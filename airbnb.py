# -*- coding: utf-8 -*-
"""airbnb.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wNh_IHGmBlJ9-fUbkJ8aImwy7-DxWeUa

The dataset that we will explore is about the Airbnb in New York for the year 2019.




The variables we have are:


```

id: Number of accommodation
neighbourhood_group: Area
room_type: Accommodation type
price:Price per night (in dollars)
availability_365:Number of days in the year that the accommodation is available for tenancy
```

# **Import the required libraries**
"""

import pandas as pd
import numpy as np
from statsmodels import robust
import statistics

"""**Importing the Dataset**"""

airbnb_data = pd.read_csv("ABNYC2019.csv",sep=" ")
airbnb_data.head()

"""**Data Preprocessing**

First of all before starting our data analysis we will check if the variables have been register right and if we have missing values(NA).
"""

airbnb_data.dtypes

"""As we can see above  we have two categorical columns

* **neighbourhood_group:**Bronx,Brooklyn,Manhattan,Queens and Staten Island.
* **room_type:**Entire home/apt, Private room	and Shared room.

while the numerical columns are
* id
* price
* availability_365

We can see below that there are not rows are missing values in our dataset.

> Add blockquote
"""

airbnb_data.isnull().sum()

"""It is also worth pointing out how price was formed in each neighbourhood with same descriptive measures like the average value(mean),the standard deviation(std),the minimum (min) and maximum (max)value and the percentile(25%,50% and 75%).Where the 50th percentile is is generally the median.


"""

airbnb_data[['price','neighbourhood_group']].groupby('neighbourhood_group').describe(include='all')

"""**Bronx:**
*   Count: The number of airbnbs that where in Bronx where 1091.
*   Mean: The average price for renting airbnb in neighbourhood Bronx is 87.49\$.
*   Standard Deviation:Is the measure that shows how far values are from the mean.The standard deviation 106.7.
*   Minimum: The minimum price for renting airbnb in neighbourhood Bronx is 0\$.
*   25th Percentile: 25\% of the prices are below 45\$
*   Median (50%):The median price is 65\$.
*   75th Percentile:The 75\% of the prices are below the 99\$.
*  Maximum:The maximum price for renting airbnb in neighbourhood Bronx is 2500\$.

**Brooklyn:**
The mean price for an airbnb in neighbourhood Brooklyn is 124.38\$,with a standard deviation of 186.87,indicates more variability in price compaired to Bronx.

**Manhattan:**
Manhattan had the majority of airbnbs in contrast with the other neighbourhoods,accounting with 21661 airbnb acomondations,the mean price is equal to 196.87\$,with astandard deviation of 291.38,indicates more variability in price compaired to Bronx and Brooklyn but also and from Quess and Staten Island.


**Queens:**
The mean price for an airbnb in the neighbourhood Queens is 99.51\$,with a standard deviation of 167.10.


**Staten Island:**
In the neighbourhood Staten Island has the least airbnb homes in contrast with the the other neighbourhood, with the mean price to be equaly with 114.81\$,with a standard deviation of 277.62.

To be more precise the Manhattan had the largest average price among the neighbourhoods,with 196.87\$ followed by Brooklyn with 124.38\$.
The standard deviation(std) in both five neighbourhoods is large standard deviation , that means that a great discrepancy can be observed among the prices of airbnbs in each neighbourhood.Clearly this is something that we can see from the difference in the deviation of the minimum price and maximum price.

Another feature that can be observed is that in all the neighbourhoods the median price is strictly less than average(median< mean)something that indicates the fact that the distribution is
positively skewed distribution.But with the skewness and kirtosis mesurments we will check them latter.
"""

import seaborn as sns
sns.set_theme()

sns.boxplot(data=airbnb_data, x="neighbourhood_group", y="availability_365").set(title='Availability for Booking', xlabel='Neighbourhood', ylabel='Availability')

"""
*   What is also worth pointing is the number of days in the year that the accommodation is available for tenancy in each neighbourhood.

*   Brooklyn and Manhattan have very similar distributions.

*   In addiction in the diagram below we can see that the availability of accommodations in the Staten Island area tends to have a somewhat more symmetrical distribution.

*   Unlike the rest of the regions which have positively skewed,that the median number of days that the airbnbs is available is stricly less thatn the average of the number of days that the airbnbs is available.

* We notice that in the Brooklyn and Manhattan areas the minimum value coincides with the value of the first quartile.

* Finally, in our dataset we see that we do not have any outliers.


"""

airbnb_data.groupby('neighbourhood_group')['availability_365'].median()

airbnb_data.groupby('neighbourhood_group')['availability_365'].mean()

"""An interesting question is in which neighborhood each accomondation type was most popular.

As we can see from the table below in Manhattan most airbnbs were entire homes or appartments,while in Brooklyn the most airbnbs were private rooms.The airbnbs which were shared rooms were the least prefeared in all neighbourhoods with the Manhattan to have the majority of them.
"""

x = pd.crosstab(index=airbnb_data["room_type"], columns=airbnb_data["neighbourhood_group"])
x

"""Something that we can visually check from the barchart below.

"""

import seaborn as sns
sns.set_theme()
g =sns.catplot(x ="neighbourhood_group", hue ="room_type",kind ="count", data = airbnb_data,palette="husl")
g.set_axis_labels("Location","")
g.fig.suptitle("Bar Plot of room type by location")

"""The next step  is too categorize the price using the quantiles.

"""

airbnb_data['price_grp'] = pd.qcut(airbnb_data['price'],
                                    q=[.0, .25, .5, .75,1],
                                   labels=["Cheap","Average","Expensive","Super Expensive"])

"""Something more interesting is to see which Airbnb has been available for more than six months. To be more precise that means that which Airbnb is available for more than 180 days(6*30=180) will be categorized as 1 in a new variable 'availability_6m' and 0 is there is available for less than 6 months."""

airbnb_data.loc[airbnb_data['availability_365']> 180, 'availability_6m'] = 'More than 6 months'
airbnb_data.loc[airbnb_data['availability_365']<=180, 'availability_6m'] = 'Less than 6 months'

"""So the new dataset is :"""

airbnb_data.head()

"""Moreover the accommodations in all price group (price_grp) most of them they have been available for less than 6 months."""

x2 =pd.crosstab(index=airbnb_data['availability_6m'],columns=airbnb_data['price_grp'])
x2

"""That is something that we can see and from the bar chart below."""

sns.set_theme(style="white", palette="Set2")
s =sns.catplot(x='price_grp',hue='availability_6m',kind='count',data=airbnb_data,palette='husl')
s.set_axis_labels("Price Group","")
s.fig.suptitle("Bar Plot For Availability By Price Group")

"""Additional the average price of the houses that were available for less than 6 months were 142\$ while the average price for the Airbnbs that were available for more than 6 months stood at 178\$.  """

airbnb_data.groupby('availability_6m')['price'].mean()

"""Furthermore we will check the average price in each price group.
More speciffically the average price for the airbnbs that are in the category Cheap are 50\$, in the category Average the mean price amounted 87\$.
While the houses that were in expensive group with an average approximately 140\$ and the houses that were in Super Expensive group were 335\$.
"""

airbnb_data.groupby('price_grp')['price'].mean()

"""The following dataset will have all the columns but only for the neighbourhood Bronx and Staten Island and will be named **data**."""

data = airbnb_data[(airbnb_data["neighbourhood_group"] == 'Bronx') | (airbnb_data["neighbourhood_group"] == 'Staten Island')]

data.head()

"""First we will check  the availability of booking in New York,from the first dataset,using the boxplot.
In this boxplot there are  include all of the neighbourhoods.

The first thing that we observe is  that the minimum value is equal represented with the 25th percentile(Q1) to zero. The average number of days that an airbnb is available in New York is less than 50 days and the 75% of the days that is available are below 227. Finally the maximum value is more than 350 and we do not have outliers.

Moreover from the table we see that the median is stricly less that the mean, something that indicates the fact that the distribution is positively skewed distridution.
"""

airbnb_data['availability_365'].describe(include='all')

sns.set_theme()

sns.boxplot(data=airbnb_data, y="availability_365",color='plum').set(title='Availability for Booking', xlabel='NEW YORK', ylabel='Availability')

"""However in the second dataset that we have the data only for the neighbourhoods Bronx and Staten Island.

The first thing that we observe is that the data have a  more symmetrical siatridution in contrast with the boxplot above.
"""

data['availability_365'].describe(include='all')

sns.set_theme()
sns.boxplot(data=data, y="availability_365",color='royalblue').set(title='Availability for Booking', xlabel='Bronx and Staten Island', ylabel='Availability')

"""The largest amount of money that they have payed for an airbnb  in the dataset that conatains only the neighbourhoods Bronx and Staten Island (named data) is  5000\$."""

data['price'].max()

airbnb_data['price'].max()

"""
In our analysis, we examined the distridution of the variable price in the both dataset,namely airbnb_data and data."""

from scipy.stats import skew
from scipy.stats import kurtosis

"""The skewness of the variable price in the first dataset named airbnb_data is equal to 19.11"""

print(skew(airbnb_data['price']))

"""
And  the Kurtosis to the dataset airbnb_data is 585.61."""

print(kurtosis(airbnb_data['price']))

"""From the above results we can conclude that the distridution of the variable  price in the dataset airbnb_data is positively skewed distribution.

Admittedly,from the skewness we can also conclude tha there is a significant concentration of lower priced registration, whith a long tail of higher priced registration on the right side of the distridution.

While from the kurtosis that the distridution in the dataset airbnb_data  is leptokurtic.



From the high kurtosis value we can assume that the high level of peakedness and tail thickness in the distribution of one or more variables within the dataset airbnb_data.This suggest that market with a signifficant price variation ,extreme price values(both high and low),

Additionally  for the dataset data we can see that the skewness of the variable price is equal to 19.83 while the kurtosis in the dataset data is 526.85.
"""

print(skew(data['price']))

print(kurtosis(data['price']))

"""From the kurtosis values suggests a leptokurtic distribution for the variable price, there are some extreme prices but the variation is less than in the dataset named airbnb_data .

Obviously, the  high skewness, in both datasets, indicates that there are more low-priced airbnb facilities with few high-priced.

Even thought, the kirtosis values for the  real estate market in the second dataset,named data, which contain only the neighbourhoods Bronx and Staten Island, indicates to be slightly stable in contrast with the first dataset, named airbnb_data.

One way to normalize the data is to use the log transformation.
The log transformation normalize  the right-skewed distribution,so
"""

print(skew(np.log(airbnb_data['price']+10**(-6))))

print(kurtosis(np.log(airbnb_data['price']+10**(-6))))

print(skew(np.log(data['price']+10**(-6))))

print(kurtosis(np.log(data['price']+10**(-6))))

"""12"""

import matplotlib.pyplot as plt

res = []

for i in range(50):
    ind = np.random.choice(data['price'].index, 150)
    res.append(data['price'][ind].mean())

plt.hist(res)
plt.show()